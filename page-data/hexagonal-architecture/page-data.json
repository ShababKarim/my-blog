{"componentChunkName":"component---src-templates-blog-post-js","path":"/hexagonal-architecture/","result":{"data":{"site":{"siteMetadata":{"title":"Hi, I'm Shabab üëãüèΩ"}},"markdownRemark":{"id":"5238e3ae-66b9-5e46-80d5-f8413d17b199","excerpt":"Hexagonal Architecture (a.k.a Ports & Adapters, Clean Architecture, etc.) is a pattern in software devlopment that describes how to effectively achieve‚Ä¶","html":"<p><em>Hexagonal Architecture (a.k.a Ports &#x26; Adapters, Clean Architecture, etc.) is a pattern in software devlopment that describes how to effectively achieve 'separation of concerns.'</em></p>\n<h3><em>So. Many. Packages.</em></h3>\n<p>Software engineering has evolved over time to require us to write less code than ever before. Think about how incredibly easy it is to learn to publish a package with utility functions to your favorite registry. There seems to be a Javascript package to do <a href=\"https://dev.to/codesphere/javascript-flaws-5-stupid-npm-packages-5fi\">just about anything</a> these days üòÖ</p>\n<p>These integrations present risks for our application. Imagine a package becomes outdated, begins to fail testing, or worse, has security vulnerabilities. The Clean Code mantra of wrapping third-party dependencies (via the <a href=\"https://github.com/ryanmcdermott/clean-code-javascript#dependency-inversion-principle-dip\">Dependency Inversion Principle</a>) is important in redcuing bloat and the risk of using \"bad\" packages.</p>\n<p>But what about other integration points? How do we manage DBs and cloud services? How about fully-bootstrapped frameworks?</p>\n<h3><em>Customers Don't Care About Your Tech Stack</em></h3>\n<p>Ultimately, we need to avoid being tied to something that may change in the future. Instead, we should focus on designing our applications focused on solving business problems rather than picking technologies. <a href=\"https://alistair.cockburn.us/hexagonal-architecture/\">Hexagonal Architecture</a>, as proposed by Alistair Cockburn, describes how to create apps that are \"developed and tested in isolation from its eventual run-time devices and databases.\"</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d2a22eda273b891c251bbbdbb1efd832/d165a/hexagonal.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.24324324324324%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwAEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAID/9oADAMBAAIQAxAAAAHpDrIVeWQ//8QAGBABAQEBAQAAAAAAAAAAAAAAAgEDEiH/2gAIAQEAAQUC2aEGjjjkjy7gw5U8n//EABkRAAIDAQAAAAAAAAAAAAAAAAABAhIhMf/aAAgBAwEBPwFONd6Yf//EABYRAAMAAAAAAAAAAAAAAAAAABARIf/aAAgBAgEBPwGsf//EABsQAAMAAwEBAAAAAAAAAAAAAAABEQIhMRJx/9oACAEBAAY/Au7ZM30jyr+DrL6pt0//xAAbEAEAAwADAQAAAAAAAAAAAAABABEhMUFRYf/aAAgBAQABPyFUF0zOJTJjJlAYsVZVXPk3qXULQi9Z/9oADAMBAAIAAwAAABDfD//EABkRAQACAwAAAAAAAAAAAAAAAAEAETGR8P/aAAgBAwEBPxC2BC3x2p//xAAXEQADAQAAAAAAAAAAAAAAAAAAAREx/9oACAECAQE/EGoTBU//xAAdEAEAAgICAwAAAAAAAAAAAAABABEhYTFRgZGx/9oACAEBAAE/EMza8RXrcPtFCC63BauSRb6mdcDTj1DqcMkyPmaYUB8n/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Hexagonal Architecture Diagram\"\n        title=\"\"\n        src=\"/static/d2a22eda273b891c251bbbdbb1efd832/1c72d/hexagonal.jpg\"\n        srcset=\"/static/d2a22eda273b891c251bbbdbb1efd832/a80bd/hexagonal.jpg 148w,\n/static/d2a22eda273b891c251bbbdbb1efd832/1c91a/hexagonal.jpg 295w,\n/static/d2a22eda273b891c251bbbdbb1efd832/1c72d/hexagonal.jpg 590w,\n/static/d2a22eda273b891c251bbbdbb1efd832/a8a14/hexagonal.jpg 885w,\n/static/d2a22eda273b891c251bbbdbb1efd832/fbd2c/hexagonal.jpg 1180w,\n/static/d2a22eda273b891c251bbbdbb1efd832/d165a/hexagonal.jpg 1400w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span style=\"text-align: center; color:#777\">A dependency diagram from Netflix's Medium Blog</span></p>\n<p>This diagram from <a href=\"https://netflixtechblog.com/ready-for-changes-with-hexagonal-architecture-b315ec967749\">Netflix's Blog</a> expounds on the fundamental idea that core business logic shouldn't be part of code that orchestrates APIs and DBs. Developers should focus on creating the core functionality, as represented by the center, <em>before</em> any decision is even made on which technologies to use, as represented by the outermost layer.</p>\n<h3><em>Layers</em></h3>\n<p>The dependency flow points inwards to convey that each layer can't be dependent on the layer outside of it. A layer can <em>only</em> depend on components either at the same level or further in.</p>\n<ul>\n<li>\n<p><em>Entities</em> - The core domain objects in our application which have no dependencies and are independently testable.</p>\n</li>\n<li>\n<p><em>Interactors &#x26; repositories</em> - <strong>Interactors</strong> are service objects that have business logic. They're called by the outer layer and \"protect\" the app's entities through input validation. Interactors utilize <strong>repositories</strong> to retrieve data to perform its logic. Repositories are interfaces for data sources. Whether that data source be a NoSQL DB or an API doesn't matter to an interactor.</p>\n</li>\n<li>\n<p><em>Data Sources &#x26; Transport</em> - <strong>Data Sources</strong> are concrete implementations of repositories. This could be APIs, DBs, excel sheets, S3 buckets, etc. as long as they fulfill the contract of the interface. <strong>Transport</strong> is also concrete but doesn't necessarily implement an interface. They provide a mechanism for a client to interact with the app and call the appropriate interactor through its methods or functions. Some implementations include REST, gRPC, and CLI.</p>\n</li>\n</ul>\n<p>The practical purpose of putting data sources and transport on the outer banks of an application are to make them <strong>swappable</strong>. If an API becomes expensive or unreliable, you can reevaluate and implement a new data source just by following the repository interface. If you need to rapidly prototype, maybe your transport-of-choice is CLI. Then after the first iteration, you could swap it out for a web framework.</p>\n<p><strong>Note</strong>: Hexagonal Architecture goes by many names. One of those names for the pattern is <em>Ports &#x26; Adapters</em>. The repositories (interfaces for data) of our application are considered \"<strong>ports</strong>\" and the concrete implementation (actual data sources and transport) are the \"<strong>adapters</strong>.\" Interactors are still considered services.</p>\n<p>It's simpler than differentiating between a \"repository\" and a \"data source\" because those names could be interchangeable in other contexts.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 93.24324324324323%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAEEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHvSZk1haAD/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAECEAMhMf/aAAgBAQABBQKkPZjg4i5f/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAGRAAAQUAAAAAAAAAAAAAAAAAAQAQESAx/9oACAEBAAY/An1GTX//xAAbEAACAwADAAAAAAAAAAAAAAARIQABYSAxUf/aAAgBAQABPyFnIUrM6OVaqbyHwtmh3h//2gAMAwEAAgADAAAAEEsPAP/EABcRAQEBAQAAAAAAAAAAAAAAAAERABD/2gAIAQMBAT8QrQme/wD/xAAWEQEBAQAAAAAAAAAAAAAAAAABESD/2gAIAQIBAT8QARbj/8QAGxABAAMBAQEBAAAAAAAAAAAAAQARITFRocH/2gAIAQEAAT8QW009ZG6WQcE2JShHxidYIXqacP3ZsV+6UXdbEE0gAUFT/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Ports &amp; Adapters Diagram\"\n        title=\"\"\n        src=\"/static/116e172378b9eed08fca6b3ce8865c59/1c72d/ports-and-adapters.jpg\"\n        srcset=\"/static/116e172378b9eed08fca6b3ce8865c59/a80bd/ports-and-adapters.jpg 148w,\n/static/116e172378b9eed08fca6b3ce8865c59/1c91a/ports-and-adapters.jpg 295w,\n/static/116e172378b9eed08fca6b3ce8865c59/1c72d/ports-and-adapters.jpg 590w,\n/static/116e172378b9eed08fca6b3ce8865c59/a8a14/ports-and-adapters.jpg 885w,\n/static/116e172378b9eed08fca6b3ce8865c59/fbd2c/ports-and-adapters.jpg 1180w,\n/static/116e172378b9eed08fca6b3ce8865c59/e343f/ports-and-adapters.jpg 1541w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n<span style=\"text-align: center; color:#777\">Ports &#x26; Adapters diagram from <a href=\"https://medium.com/idealo-tech-blog/hexagonal-ports-adapters-architecture-e3617bcf00a0\">https://medium.com/idealo-tech-blog/hexagonal-ports-adapters-architecture-e3617bcf00a0</a></span></p>\n<p>Let's go ahead and build a basic app to demonstrate these concepts üöÄ</p>\n<h3><em>The App</em></h3>\n<p><strong>Note</strong>: To follow along with the full code for the project, <a href=\"https://github.com/ShababKarim/my-blog-code/tree/main/hexagonal-architecture\">click here</a>.</p>\n<p>Let's define the requirements for this project.</p>\n<p><strong>Requirements</strong>: The app will give customers the ability to quickly get issues on their open-source project assigned to interested engineers. Engineers will be able to register themselves to the service. They can also update their progress on an assigned issue. Not every piece of functionality must be built, like updating an engineer's interests. Certain components can be mocked.</p>\n<p>Sounds easy enough! We'll take it piece-by-piece.</p>\n<p>We'll use <a href=\"https://bun.sh/\">BunJS</a> as the runtime for our application. If you're not familiar, BunJS is a drop-in replacement for Node and has great support for Typescript!</p>\n<p>We'll start by installing BunJS and generating our project:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-fsSL</span> https://bun.sh/install <span class=\"token operator\">|</span> <span class=\"token function\">bash</span> <span class=\"token comment\"># Install Bun</span>\n\nbun init <span class=\"token comment\"># Create a Bun project</span></code></pre></div>\n<h4><em>Entities &#x26; Commands</em></h4>\n<p>Once our project structure is created we'll move the index.ts file into a <code class=\"language-text\">src/</code> directory to keep the root of the project clean.</p>\n<p>We'll also create a <code class=\"language-text\">src/domain/</code> directory to house domain-related code. At the root here will be the entities of our app: projects and engineers.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">‚îú‚îÄ‚îÄ src\n‚îÇ   ‚îú‚îÄ‚îÄ domain\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ project.ts\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ engineer.ts\n‚îÇ   ‚îî‚îÄ‚îÄ index.ts\n‚îî‚îÄ‚îÄ tsconfig.json</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// project.ts</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">generateId</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">account</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> account<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Project</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span> <span class=\"token comment\">// ID is account/name</span>\n    <span class=\"token literal-property property\">account</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n    <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n    <span class=\"token literal-property property\">issues</span><span class=\"token operator\">:</span> Issue<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Issue</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">url</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span> <span class=\"token comment\">// ID</span>\n    <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n    <span class=\"token literal-property property\">description</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n    <span class=\"token literal-property property\">reporter</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n    <span class=\"token literal-property property\">assignedEngineer</span><span class=\"token operator\">:</span> Engineer <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n    <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> Status<span class=\"token punctuation\">;</span>\n    <span class=\"token literal-property property\">lastUpdated</span><span class=\"token operator\">:</span> Date<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">enum</span> Status <span class=\"token punctuation\">{</span>\n    <span class=\"token constant\">NOT_YET_STARTED</span> <span class=\"token operator\">=</span> <span class=\"token string\">'NOT YET STARTED'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">STARTED</span> <span class=\"token operator\">=</span> <span class=\"token string\">'STARTED'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">DONE</span> <span class=\"token operator\">=</span> <span class=\"token string\">'DONE'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">BLOCKED</span> <span class=\"token operator\">=</span> <span class=\"token string\">'BLOCKED'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// engineer.ts</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Engineer</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">email</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span> <span class=\"token comment\">// ID</span>\n    <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n    <span class=\"token literal-property property\">interestedProjects</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>These TS interfaces are the core carriers of information within our app. When we think about our requirements spec, the first thing that jumps to mind is that there are open-source projects with issues and engineers to work on them. So we model them accordingly without thinking about extra details like normalized table design. We are trying to reflect the language of the problem accurately and concisely.</p>\n<p>We'll also create another set of domain objects called <code class=\"language-text\">commands</code> in <code class=\"language-text\">src/domain/</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// commands.ts</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">RegisterEngineer</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n    <span class=\"token literal-property property\">email</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">MatchEngineerToProject</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">account</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n    <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">UpdateIssueStatus</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">projectId</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n    <span class=\"token literal-property property\">issueUrl</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n    <span class=\"token literal-property property\">newStatus</span><span class=\"token operator\">:</span> Status<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The 3 APIs we mentioned at the outset: registering engineers, matching engineers to issues, and updating an issue's status are shown here.</p>\n<p>This is because we are now thinking about how a client will interact with our app. What sort of APIs are we exposing to the outside world? How much data do we require to perform these functions?</p>\n<p>Commands are the currency between the outside world and our services üí∏</p>\n<h4><em>Interactors &#x26; Repositories (ports)</em></h4>\n<p>The first step in implementing business logic is creating input and output port interfaces so they can be wired up to our interactors.</p>\n<p>Inside of src/domain we'll add 2 directories: <code class=\"language-text\">src/domain/ports/input/</code> and <code class=\"language-text\">src/domain/ports/output/</code></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">‚îú‚îÄ‚îÄ domain\n‚îÇ   ‚îú‚îÄ‚îÄ ports\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ input\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ output\n‚îî‚îÄ‚îÄ index.ts</code></pre></div>\n<p>Let's create 2 output ports: 1 for retrieving a project's issue list and the other to talk to our DB.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// project.ts</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">ProjectApi</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">getRepoDetails</span><span class=\"token punctuation\">(</span>account<span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Promise<span class=\"token operator\">&lt;</span>Project<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token comment\">// repository.ts</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Repository</span><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">V</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Promise<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">getById</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token constant\">V</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Promise<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">save</span><span class=\"token punctuation\">(</span>entity<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Promise<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">saveAll</span><span class=\"token punctuation\">(</span>entities<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Promise<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>They are essentially just contracts that no matter what adapter we wire-in to retrieve data, the adapter will need to support these methods and not break our app.</p>\n<p>Going back to our directory structure, we have input ports we need to define. In P&#x26;A, these are called \"driving ports\" because they allow communication from the outside world. Although the inner layers of our app won't depend on them, they, like ouput ports, are contracts for the type of transport we choose to use.</p>\n<p>For our app, we'll define a web port in <code class=\"language-text\">src/domain/input.</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// web.ts</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">enum</span> HttpVerb <span class=\"token punctuation\">{</span>\n    <span class=\"token constant\">GET</span> <span class=\"token operator\">=</span> <span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">POST</span> <span class=\"token operator\">=</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">PUT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'PUT'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">DELETE</span> <span class=\"token operator\">=</span> <span class=\"token string\">'DELETE'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Route</span><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">verb</span><span class=\"token operator\">:</span> HttpVerb<span class=\"token punctuation\">;</span>\n    <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n    <span class=\"token literal-property property\">handler</span><span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">WebServer</span><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">addRoute</span><span class=\"token punctuation\">(</span>route<span class=\"token operator\">:</span> Route<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> WebServer<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>port<span class=\"token operator\">:</span> number<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Finally, we'll tackle our interactors. Inside <code class=\"language-text\">src/domain/</code> create a directory called <code class=\"language-text\">service/</code>. It'll house all the necessary business logic. For each of the 3 commands we create functions as handlers:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">\n<span class=\"token comment\">// assignment.ts</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">matchEngineerToProject</span><span class=\"token punctuation\">(</span>\n    <span class=\"token parameter\"><span class=\"token literal-property property\">projectApi</span><span class=\"token operator\">:</span> ProjectApi<span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">engineerRepository</span><span class=\"token operator\">:</span> Repository<span class=\"token operator\">&lt;</span>Engineer<span class=\"token punctuation\">,</span> string<span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">projectRepository</span><span class=\"token operator\">:</span> Repository<span class=\"token operator\">&lt;</span>Project<span class=\"token punctuation\">,</span> string<span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">command</span><span class=\"token operator\">:</span> MatchEngineerToProject</span>\n<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Promise<span class=\"token operator\">&lt;</span>Project<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">validateMatchEngineerToProjectCommand</span><span class=\"token punctuation\">(</span>command<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> project <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getOrUpdateProject</span><span class=\"token punctuation\">(</span>projectApi<span class=\"token punctuation\">,</span> projectRepository<span class=\"token punctuation\">,</span> command<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> interestedEngineers <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getInterestedEngineers</span><span class=\"token punctuation\">(</span>engineerRepository<span class=\"token punctuation\">,</span> project<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> projectWithAssignedIssues <span class=\"token operator\">=</span> <span class=\"token function\">assignIssuesToEngineers</span><span class=\"token punctuation\">(</span>project<span class=\"token punctuation\">,</span> interestedEngineers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    projectRepository<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>projectWithAssignedIssues<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> projectWithAssignedIssues<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// register.ts</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">registerEngineer</span><span class=\"token punctuation\">(</span>\n    <span class=\"token parameter\"><span class=\"token literal-property property\">repository</span><span class=\"token operator\">:</span> Repository<span class=\"token operator\">&lt;</span>Engineer<span class=\"token punctuation\">,</span> string<span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">command</span><span class=\"token operator\">:</span> RegisterEngineer</span>\n<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Promise<span class=\"token operator\">&lt;</span>Engineer<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">isValidEmailAndName</span><span class=\"token punctuation\">(</span>command<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Cannot register user with invalid email and/or name</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">const</span> engineerExists <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> repository<span class=\"token punctuation\">.</span><span class=\"token function\">getById</span><span class=\"token punctuation\">(</span>command<span class=\"token punctuation\">.</span>email<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>engineerExists<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Cannot register </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>command<span class=\"token punctuation\">.</span>email<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">. A user with that email already exists</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> repository<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>command<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">interestedProjects</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">engineer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> engineer<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// status.ts</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">updateIssueStatus</span><span class=\"token punctuation\">(</span>\n    <span class=\"token parameter\"><span class=\"token literal-property property\">projectRepository</span><span class=\"token operator\">:</span> Repository<span class=\"token operator\">&lt;</span>Project<span class=\"token punctuation\">,</span> string<span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">command</span><span class=\"token operator\">:</span> UpdateIssueStatus</span>\n<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Promise<span class=\"token operator\">&lt;</span>Project<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">validateUpdateIssueStatusCommand</span><span class=\"token punctuation\">(</span>command<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> projectWithUpdatedIssue <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">updateProjectIssues</span><span class=\"token punctuation\">(</span>projectRepository<span class=\"token punctuation\">,</span> command<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> projectRepository<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>projectWithUpdatedIssue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The logic of these functions are relatively simple: validate the input, update the entity, and save back to the DB. If someone wanted to change the DB at runtime, it would be easy to swap because the service depends strictly on interfaces.</p>\n<h4><em>Transport &#x26; Data Sources (Adapters)</em></h4>\n<p>We've delayed long enough! This is the stage where we start to think about wiring the app to external services. I decided to forego adding a DB and instead chose to hold the data in-memory. As you'll see below, there is room to change the implementation and connect to a DB if you need to.</p>\n<p>We'll begin by creating a directory in <code class=\"language-text\">src/domain/output/</code> called <code class=\"language-text\">adapters/</code> and add:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">\n<span class=\"token comment\">// project-repository.ts</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ProjectRepository</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Repository</span><span class=\"token operator\">&lt;</span>Project<span class=\"token punctuation\">,</span> string<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">projects</span><span class=\"token operator\">:</span> Project<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>projects <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Promise<span class=\"token operator\">&lt;</span>Project<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>projects<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Omitted for brevity</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// engineer-repository.ts</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">EngineerRepository</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Repository</span><span class=\"token operator\">&lt;</span>Engineer<span class=\"token punctuation\">,</span> string<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">engineers</span><span class=\"token operator\">:</span> Engineer<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>engineers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token literal-property property\">email</span><span class=\"token operator\">:</span> <span class=\"token string\">'bob@gmail.com'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'bob'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">interestedProjects</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'spring-projects/spring-boot'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'facebook/react-native'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token literal-property property\">email</span><span class=\"token operator\">:</span> <span class=\"token string\">'alice@gmail.com'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'alice'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">interestedProjects</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'facebook/react-native'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Promise<span class=\"token operator\">&lt;</span>Engineer<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>engineers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Omitted for brevity</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// github-project-api.ts</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">GithubProjectApi</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">ProjectApi</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">async</span> <span class=\"token function\">getRepoDetails</span><span class=\"token punctuation\">(</span>account<span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Promise<span class=\"token operator\">&lt;</span>Project<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isInvalidAccountAndRepo</span><span class=\"token punctuation\">(</span>account<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Cannot retrieve project with invalid account and/or repo name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">const</span> issuesList <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">generateApiUrl</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ISSUES_API</span><span class=\"token punctuation\">,</span> account<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>\n            <span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> any\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// Omitted for brevity</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>Note</strong>: The data is saved in-memory for projects and engineers but we source the project and issue data directly from Github.</p>\n<p>Then we'll wire up the input port. We're going to opt for a Bun web framework called <a href=\"https://elysiajs.com/\">ElysiaJS</a>.</p>\n<p>We can install Elysia as a dependency by running:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">bun <span class=\"token function\">add</span> elysia</code></pre></div>\n<p>Then we'll create a directory in <code class=\"language-text\">src/domain/input/</code> called <code class=\"language-text\">adapters/</code> and add:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// controller.ts</span>\n\n<span class=\"token comment\">// Ommitted for brevity</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">startApp</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">port</span><span class=\"token operator\">:</span> number</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> engineerRepository <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">EngineerRepository</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> projectRepository <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ProjectRepository</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> projectApi <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GithubProjectApi</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">ElysiaServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">addRoute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">verb</span><span class=\"token operator\">:</span> HttpVerb<span class=\"token punctuation\">.</span><span class=\"token constant\">POST</span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">'/register'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token function-variable function\">handler</span><span class=\"token operator\">:</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> body <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> <span class=\"token function\">registerEngineer</span><span class=\"token punctuation\">(</span>engineerRepository<span class=\"token punctuation\">,</span> body <span class=\"token keyword\">as</span> RegisterEngineer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">addRoute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">verb</span><span class=\"token operator\">:</span> HttpVerb<span class=\"token punctuation\">.</span><span class=\"token constant\">POST</span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">'/assign'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token function-variable function\">handler</span><span class=\"token operator\">:</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> body <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> <span class=\"token function\">matchEngineerToProject</span><span class=\"token punctuation\">(</span>\n                    projectApi<span class=\"token punctuation\">,</span>\n                    engineerRepository<span class=\"token punctuation\">,</span>\n                    projectRepository<span class=\"token punctuation\">,</span>\n                    body <span class=\"token keyword\">as</span> MatchEngineerToProject\n                <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">addRoute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">verb</span><span class=\"token operator\">:</span> HttpVerb<span class=\"token punctuation\">.</span><span class=\"token constant\">POST</span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">'/update'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token function-variable function\">handler</span><span class=\"token operator\">:</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> body <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> <span class=\"token function\">updateIssueStatus</span><span class=\"token punctuation\">(</span>projectRepository<span class=\"token punctuation\">,</span> body <span class=\"token keyword\">as</span> UpdateIssueStatus<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Here we've created a function to create the necessary dependencies and an instance of a web server to handle user input. The web adapter calls the appropriate interactor based on the endpoint and passes a command.</p>\n<p>We'll plug this back into to <code class=\"language-text\">index.ts</code> like so:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// index.ts</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> startApp <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./domain/ports/input/adapters/controller'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">startApp</span><span class=\"token punctuation\">(</span><span class=\"token number\">8080</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>and voila! We have a complete web application!</p>\n<p>Let's run some commands and see the output!</p>\n<h4><em>Running the app</em></h4>\n<p>First we'll register a new user:</p>\n<p><code class=\"language-text\">POST http://localhost:8080/register {\"email\": \"casey@gmail.com\", \"name\": \"casey\"} </code></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ bun src/index.ts\nStarting server on port 8080...\nRetrieving engineer by id casey@gmail.com\nSaved/updated engineer with id casey@gmail.com\nRegistered new user casey@gmail.com</code></pre></div>\n<p>Then assign interested engineers to my favorite open-source project ‚ù§Ô∏è:</p>\n<p><code class=\"language-text\">POST http://localhost:8080/assign {\"account\": \"spring-projects\", \"name\": \"spring-boot\"}</code></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Retrieving repo by id spring-projects/spring-boot\nRetrieved 30 issue(s) for account/repo: spring-projects/spring-boot\nSaved/updated repo with id spring-projects/spring-boot\nRetrieving all engineers\nAssigning 30 issue(s) across 1 interested engineer(s) for project spring-projects/spring-boot\nAssigned 30 issue(s) for project spring-projects/spring-boot\nSaved/updated repo with id spring-projects/spring-boot</code></pre></div>\n<p>And finally update an issue's status to <code class=\"language-text\">STARTED</code>:</p>\n<p><code class=\"language-text\">POST http://localhost:8080/update {\"projectId\": \"spring-projects/spring-boot\", \"issueUrl\": \"https://api.github.com/repos/spring-projects/spring-boot/issues/39331\", \"newStatus\": \"STARTED\"}</code></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Retrieving repo by id spring-projects/spring-boot\nUpdated issue https://api.github.com/repos/spring-projects/spring-boot/issues/39331 with status STARTED for project spring-projects/spring-boot\nSaved/updated repo with id spring-projects/spring-boot</code></pre></div>\n<p>There we go! We've validated all three APIs that were mentioned in the requirements ü•≥</p>\n<h3><em>Wrapping Up</em></h3>\n<p>Hexagonal Architecture helps a lot in separating our business logic from code that interacts with our dependencies. Without worrying about external services, we can rapidly develop the first iteration of our product and get feedback before making it production-ready.</p>\n<p>Whether in the future you choose to use Postgres, MonogDB, Kafka, SQS, MongoDB, etc. it's all about <strong>delaying</strong> your decision. There <strong>should be</strong> no lock-in to a particular technology because of the problem you are trying to solve.</p>\n<p>However, there are always edge-cases where a specific tool must be used. The goal then, should be to minimize them as much as possible.</p>\n<p>Beyond this dicussion, keep learning good design principles and exercising sound judgement. The rest will eventually fall into place.</p>\n<p>Thanks for reading! Please leave some feedback by sending me a message on LinkedIn and stay tuned for the next article üòä</p>","frontmatter":{"title":"Hexagonal Architecture in Javascript","date":"February 02, 2024","description":"Hexagonal Architecture (a.k.a Ports & Adapters, Clean Architecture, etc.) is a pattern in software devlopment that describes how to effectively achieve 'separation of concerns.'"}},"previous":{"fields":{"slug":"/welcome/"},"frontmatter":{"title":"Welcome to My Blog"}},"next":null},"pageContext":{"id":"5238e3ae-66b9-5e46-80d5-f8413d17b199","previousPostId":"734428fd-a9fa-5725-a8d7-53f4b6664c44","nextPostId":null}},"staticQueryHashes":["2841359383","3257411868"],"slicesMap":{}}